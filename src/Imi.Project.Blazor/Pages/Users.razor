@page "/users"
@using Imi.Project.Blazor.Models
@using Imi.Project.Blazor.Services.Crud
@inject ICRUDService<MockUser> service;

<h3>Users</h3>

<div class="mt-3">
    @if (!string.IsNullOrEmpty(error))
    {
        <div class="alert alert-danger">
            @error
        </div>
    }

    @if (currentUser == null)
    {
        <UserList Users="users">
        </UserList>
    }
    else
    {
        <UserForm User="currentUser">
        </UserForm>
    }
</div>

@code {
    private MockUser[]? users;
    private MockUser? currentUser;
    private string? error;

    protected override async Task OnInitializedAsync()
    {
        await RefreshUsers();
    }

    public async Task RefreshUsers()
    {
        users = (await service.GetAll()).ToArray();
        this.currentUser = null;
    }

    //TODO Functions for rest of CRUD
}